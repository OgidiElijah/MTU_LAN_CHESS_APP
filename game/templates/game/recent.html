{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recent Games - MTU Chess Club</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, {{ MTU_CHESS_CONFIG.PRIMARY_COLOR }} 0%, {{ MTU_CHESS_CONFIG.SECONDARY_COLOR }} 100%);
            min-height:100vh;
            color:#222;
        }
        nav {
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(8px);
            padding:1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        nav .container { max-width:1400px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding:0 20px; }
        nav .logo { color:white; font-size:1.6rem; font-weight:bold; }
        nav .nav-links { display:flex; gap:1rem; align-items:center; }
        nav a { color:white; text-decoration:none; font-weight:600; padding:8px 12px; border-radius:6px; }
        nav a:hover { background: rgba(255,255,255,0.1); }

        .main-container { max-width:1400px; margin:30px auto; padding:0 20px; }
        .content-section { background:white; border-radius:14px; padding:24px; box-shadow:0 8px 30px rgba(0,0,0,0.15); }

        .section-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:18px; border-bottom:2px solid #f0f0f0; padding-bottom:12px; }
        .section-header h2 { color:#004d00; font-size:1.6rem; }
        .section-header a { color:#004d00; text-decoration:none; font-weight:600; }
        .section-header a:hover { text-decoration:underline; }

        .game-list { display:flex; flex-direction:column; gap:12px; }
        .game-item { display:flex; justify-content:space-between; align-items:center; padding:16px; background:#f8f9fa; border-radius:10px; border-left:4px solid #004d00; }
        .game-info { flex:1; }
        .game-code { font-family:monospace; font-weight:bold; color:#004d00; margin-bottom:6px; }
        .game-players { color:#666; font-size:0.95rem; }
        .game-status { padding:6px 12px; border-radius:16px; font-weight:700; font-size:0.9rem; }
        .status-active { background:#d4edda; color:#155724; }
        .status-completed { background:#d1ecf1; color:#0c5460; }
        .status-waiting { background:#fff3cd; color:#856404; }

        .empty-state { text-align:center; padding:40px; color:#999; }
        .empty-state-icon { font-size:3.5rem; margin-bottom:12px; }

        .sidebar { margin-top:20px; display:block; }
        .rating-box { background:white; border-radius:12px; padding:16px; box-shadow:0 6px 20px rgba(0,0,0,0.08); margin-bottom:16px; }
        .rating-box p { margin-bottom:8px; color:#333; }
        .progress-bg { width:100%; background:#eee; border-radius:6px; overflow:hidden; height:14px; }
        .progress-fill { height:100%; background:{{ MTU_CHESS_CONFIG.PRIMARY_COLOR }}; width:{{ rating_progress }}%; transition:width .3s; }

        @media (min-width:1000px){
            .layout { display:grid; grid-template-columns: 2fr 1fr; gap:24px; align-items:start; }
        }
        @media (max-width:999px){
            .layout { display:block; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="container">
            <div class="logo">‚ôü MTU Chess</div>
            <div class="nav-links">
                <a href="{% url 'dashboard' %}">Dashboard</a>
                <a href="{% url 'play' %}">Play</a>
                <a href="{% url 'tournament' %}">Tournament</a>
                <a href="{% url 'leaderboard' %}">Leaderboard</a>
                <a href="{% url 'logout' %}">Logout</a>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <div class="layout">
            <div class="content-section">
                <div class="section-header">
                    <h2>Your Recent Games</h2>
                    <a href="{% url 'dashboard' %}">Back to Dashboard</a>
                </div>

                <div class="game-list">
                    {% if user_games %}
                        {% for game in user_games %}
                        <div class="game-item">
                            <div class="game-info">
                                <div class="game-code">{{ game.code }}</div>
                                <div class="game-players">
                                    ‚ôô {{ game.get_white_display_name }} vs ‚ôü {{ game.get_black_display_name }}
                                </div>
                            </div>
                            <div class="game-status status-{{ game.status }}">
                                {{ game.get_status_display }}
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-state">
                            <div class="empty-state-icon">‚ôüÔ∏è</div>
                            <p>No games yet. Start playing to see your history!</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <aside class="sidebar">
                <div class="rating-box">
                    <p><strong>Rating</strong></p>
                    {% if user.is_rated %}
                        <p style="font-size:1.25rem;">{{ user.rating }}</p>
                    {% else %}
                        <p>{{ user.display_rating }}</p>
                        <p>Progress: {{ user.total_games }}/{{ MTU_CHESS_CONFIG.MINIMUM_GAMES_FOR_RATING }} games</p>
                        <div class="progress-bg"><div class="progress-fill"></div></div>
                    {% endif %}
                </div>

                <div class="rating-box">
                    <p><strong>Quick Stats</strong></p>
                    <p>Total Games: {{ user.total_games }}</p>
                    <p>Wins: {{ user.wins }} ‚Ä¢ Losses: {{ user.losses }} ‚Ä¢ Draws: {{ user.draws }}</p>
                </div>

                <div class="rating-box">
                    <p><strong>Live Games</strong></p>
                    {% if active_games %}
                        {% for g in active_games|slice:":3" %}
                            <div style="margin-bottom:8px; cursor:pointer;" onclick="window.location.href='{% url 'watch' g.code %}'">
                                üî¥ <span style="font-weight:700;">{{ g.code }}</span><br>
                                <small style="color:#666;">{{ g.get_white_display_name }} vs {{ g.get_black_display_name }}</small>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p style="color:#999;">No active games right now</p>
                    {% endif %}
                </div>
            </aside>
        </div>
    </div>
</body>
</html>